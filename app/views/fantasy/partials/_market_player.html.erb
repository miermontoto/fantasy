<div class="flex items-center bg-gray-700 rounded-lg p-2 hover:bg-gray-600 transition-colors w-full">
  <div class="relative flex-shrink-0">
    <img class="w-12 h-12 rounded-lg" src="<%= market_player.player_img %>" alt="<%= market_player.name %>" loading="lazy">
    <% if market_player.status.present? %>
      <div class="absolute -top-1 -right-1 w-4 h-4 rounded-full flex items-center justify-center text-xs font-bold
        <%= case market_player.status
            when 'injury' then 'bg-red-500'
            when 'doubt' then 'bg-yellow-500'
            when 'red' then 'bg-red-500'
            else ''
            end %>">
        <%= case market_player.status
            when 'injury' then '+'
            when 'doubt' then '?'
            when 'red' then '◼'
            else ''
            end %>
      </div>
    <% end %>
  </div>

  <div class="flex flex-col items-center mx-2 flex-shrink-0 border-l border-r border-gray-600 px-2">
    <img src="<%= market_player.team_img %>" alt="Team" class="w-6 h-6 mb-1">
    <div class="<%= market_player.position.browser[:color] %> border-2 border-black skew-x-[-10deg] px-2 py-0.5 rounded">
      <span class="block skew-x-[10deg] text-xs font-bold text-black"><%= market_player.position.browser[:position] %></span>
    </div>
  </div>

  <div class="flex-1 flex items-center justify-between min-w-0">
    <div class="min-w-0 flex-shrink">
      <h3 class="font-semibold truncate"><%= market_player.name %></h3>
      <div class="flex items-center gap-2 text-xs text-gray-400">
        <% if market_player.own %>
          <span class="text-blue-400 whitespace-nowrap">Tu jugador</span>
          <span class="w-1 h-1 bg-gray-500 rounded-full flex-shrink-0"></span>
        <% end %>
        <% if market_player.instance_variable_get(:@user).present? %>
          <span class="truncate"><%= market_player.instance_variable_get(:@user) %></span>
        <% end %>
      </div>
    </div>

    <div class="flex items-center gap-4 flex-shrink-0">
      <div class="flex items-center gap-3 border-l border-r border-gray-600 px-3">
        <div class="text-center w-12">
          <div class="text-sm font-semibold"><%= market_player.points %></div>
          <div class="text-xs text-gray-400">PTS</div>
        </div>
        <div class="text-center w-12">
          <div class="text-sm font-semibold"><%= market_player.average %></div>
          <div class="text-xs text-gray-400">AVG</div>
        </div>
        <div class="text-center w-12 hidden md:block">
          <div class="text-sm font-semibold"><%= market_player.ppm %></div>
          <div class="text-xs text-gray-400">PPM</div>
        </div>
      </div>

      <div class="flex items-center gap-4">
        <div class="hidden sm:flex items-center gap-1">
          <% market_player.streak.each do |points| %>
            <% points_value = points == "-" ? 0 : points.to_i %>
            <% bg_color = if points_value < 0
                 'bg-red-500'
               elsif points_value >= 10
                 'bg-cyan-500'
               elsif points_value >= 5
                 'bg-green-500'
               elsif points_value >= 1
                 'bg-yellow-500'
               else
                 'bg-gray-500'
               end %>
            <div class="<%= bg_color %> w-6 h-6 rounded-sm flex items-center justify-center text-xs font-bold">
              <%= points %>
            </div>
          <% end %>
        </div>

        <div class="hidden sm:block border-l border-gray-600 h-8"></div>

        <div class="text-right min-w-[100px]">
          <div class="flex items-center gap-1 justify-end">
            <p class="font-bold whitespace-nowrap"><%= market_player.price %></p>
            <% if market_player.trend.present? %>
              <span class="text-sm <%= market_player.trend.include?('↑') ? 'text-green-500' : 'text-red-500' %>">
                <%= market_player.trend.include?('↑') ? '↑' : '↓' %>
              </span>
            <% end %>
          </div>
          <% if market_player.instance_variable_get(:@diff) %>
            <p class="text-xs text-gray-400">
              <%= market_player.instance_variable_get(:@diff) > 0 ? '+' : '' %><%= number_to_currency(market_player.instance_variable_get(:@diff), unit: '€', precision: 0) %>
            </p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
